<head>
	<title>MeteorChat</title>
</head>

<body>
	{{> loginButtons}}
	{{#if currentUser}}
		<form id="searchform" style="background: cornsilk;">
			<input type="text" name="searchbox" placeholder="Search Users" />
		</form>
		<div>
			{{#with searchResults}}
			{{#if count}}
			<span>SearchResults for <strong>{{searchText}}</strong></span>
			<ul>
				{{#each this}}
				{{> user}}
				{{/each}}
			</ul>
			{{/if}}
			{{/with}}
		</div>

		{{> chatRooms}}
		
	{{/if}}
</body>

<template name="user">
	<li class="list-unstyled"><button class="btn btn-primary btn-xs" type="button" id="chatWith" name="chatWith">Chat</button><span>{{username}}</span></li>
</template>

<template name="chatRooms">
	{{#with chatRooms}}
		{{#if count}}
			{{#each this}}
				{{> chatRoom}}
			{{/each}}
		{{else}}
			<span>You have no chat rooms. Please search for users to chat with.</span>
		{{/if}}	
	{{else}}
		<span>You have no chat rooms. Please search for users to chat with.</span>
	{{/with}}
</template>

<template name="chatRoom">
	<div style="background: blanchedalmond;">
		<button id="deleteChatRoom" class="close" aria-label="close"><span aria-hidden="true">&times;</span></button>
		<div style="background: lightgreen;">{{#each users}}<span><strong>-{{username}}:{{seeing}}-</strong></span>{{/each}}</div>
		<br>
		<ul>
		{{#each messages}}
			{{> message}}
		{{/each}}
		</ul>
		<form id="chatform">
			<input type="hidden" name="hidden_id" value="{{_id}}" />
			<input type="text" name="chatBox" placeholder="Type your message " />
		</form>
	</div>
</template>

<template name="message">
	<li class="list-unstyled"><strong>{{from}}:</strong>{{messageText}}</li>
</template>